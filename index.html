<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <style>
        body{
            background-color: #8fc8f8;
        }
        div{
            display: hidden;
            justify-content: center;
            justify-items: center;
            
        }
        #listed{
            display: grid;
            justify-content: center;
            justify-items: center;
            
        }
        #thumbnail{
            position: absolute;
            top: 133px;
            left: 135px;
        }
        #save{
          cursor: pointer;
        }
        span{
            column-gap: 10px;
            column-count: 2;
            position: absolute;
            background-color: antiquewhite;
            right: 0px;
            top: 5px;
            padding: 10px;
        }
        
    </style>

</head>
<body>
    <div>
    <p>please enter book's name</p>
    <!-- <input type="text" id="search"  > -->
    <!-- <button id ="button">search</button> -->
   </div>
   <div class="input-group">
    <div class="form-outline">
      <input id="search-focus" type="search" id="form1"  class="form-control" placeholder="please enter book's name" />
      <!-- <label class="form-label" for="form1">Search</label> -->
    </div>
    <button type="button" class="btn btn-primary" id="buttons">
      <i class="fas fa-search">Search</i>
    </button>
  </div>

<div id="listedd" style=" display: grid; grid-template-columns: auto  auto; grid-gap: 10px; background-color: #8fc8f8; padding: 10px;"></div>
<img src="" id="thumbnail" width="150">

<div id="listed" style=" display: grid; grid-template-columns: auto auto; grid-gap: 10px; background-color: #8fc8f8; padding: 10px;"></div>
<div id="authors"></div>
<div id="ratings"></div>
<div id="title"></div>
<img src=" " id="thumbnail" style="width:150px;" >
          

<span>Hello,{{request.user}} </span>
<span><a href="{% url 'logoutUser' %}" >Logout</a></span>

<script>
  const searchFocus = document.getElementById('search-focus');
  const keys = [
    { keyCode: 'AltLeft', isTriggered: false },
    { keyCode: 'ControlLeft', isTriggered: false },
  ];
  
  window.addEventListener('keydown', (e) => {
    keys.forEach((obj) => {
      if (obj.keyCode === e.code) {
        obj.isTriggered = true;
      }
    });
  
    const shortcutTriggered = keys.filter((obj) => obj.isTriggered).length === keys.length;
  
    if (shortcutTriggered) {
      searchFocus.focus();
    }
  });
  
  window.addEventListener('keyup', (e) => {
    keys.forEach((obj) => {
      if (obj.keyCode === e.code) {
        obj.isTriggered = false;
      }
    });
  });
document.addEventListener('DOMContentLoaded',  function (){
    
    document.getElementById('buttons').onclick = async function(){
    
    let search = document.getElementById('search-focus').value;

 
    
    const api = await fetch ("https://www.googleapis.com/books/v1/volumes?q= " + search) 
    
    console.log(api)
    console.log(search)
    const respData = await api.json()
    console.log(respData)
    // console.log(respData)
    // let authors = respData.items[0].volumeInfo.imageLinks.smallThumbnail;
    // let ratings = respData.items[0].volumeInfo.previewLink;
    // let title = respData.items[0].volumeInfo.title;
    let authorss = document.getElementById('authors')
    //let imagew = document.getElementById('image').src
    let text = "";
    let rate = '';

    // for (let a = 0; a<respData.items[a].volumeInfo.imageLinks.thumbnail;  a++){
        
    // // if (respData.items[a].volumeInfo.imageLinks.thumbnail !== undefined || respData.items[0].volumeInfo.imageLinks.thumbnail !== null){
    //     //if (respData.item[a].volumeInfo.imageLinks.thumbnail !== undefined){
            
            
    //       // rate +=  document.getElementById('thumbnail').src =  respData.items[a].volumeInfo.imageLinks.thumbnail
    //       //   console.log(length)

    //   //  }else{
    //   //       console.log('nott')
    //   //  }
    //   rate +=    respData.items[a].volumeInfo.imageLinks.thumbnail;
    //   ;
  
    //    console.log(rate)

    // }
    // console.log(rate)
    // // document.getElementById('thumbnail').src = rate
    // let items = respData.items;
  //  console.log(respData.headers.url)
     for (let i = 0; i< 9; i++ ) {
      //text +=  "<br>" +`${respData.items[i].volumeInfo.title} `; `${respData.items[i].volumeInfo.imageLinks.smallThumbnail}`;
      // let item = items[i].volumeInfo;
      // let book = item.imageLinks.thumbnail;
    //   if (book !==undefined || book!== null ){
    //     //  document.getElementById('rating').innerHTML = `Rating : ${respData.items[1].volumeInfo.averageRating}`
    //       let book = `${respData.items[i].volumeInfo.imageLinks.thumbnail}`
  
    //      // console.log(rating)
    //    //   console.log(image)
    //   }else{ 
    //      // document.getElementById('rating').innerHTML = `Rating : ${respData.items[3].volumeInfo.averageRating}`
    //       let book = `${respData.items[3].volumeInfo.imageLinks.thumbnail}`
    //   }
    //    //console.log(book)
    //      // console.log(respData.items[i].volumeInfo.imageLinks.smallThumbnail)
    //      {
    //         book[i]  ? 
    //         `<img src=${book[i]}></img>`: null
    //     }
      // let book = respData.items[i].volumeInfo.imageLinks.thumbnail 
      // if (book !== undefined || book !== null){
    //   //if (respData.item[a].volumeInfo.imageLinks.thumbnail !== undefined){
    //       // console.log(respData.items[a].volumeInfo.imageLinks.thumbnail)
    //     book 
          
    //   //   rate +=  document.getElementById('thumbnail').src =  respData.items[a].volumeInfo.imageLinks.thumbnail
    //   //     console.log(length)

    //  }else{
    //     book= " "
    //       console.log('nott')
    //  }
        //for (let a = respData.items[i].volumeInfo.imageLinks.thumbnail; a< 10; a++){
      /*  text +=` <div class="card-group">
            <div class="card">
              <div class="card-body">
              <img src="${respData.items[i].volumeInfo.imageLinks.thumbnail}" alt="W3Schools.com" width="100" height="132">
                <h5 class="card-title">${respData.items[i].volumeInfo.authors}</h5>
                <h5 class="card-title">  ${respData.items[i].volumeInfo.averageRating}⭐</h5>
                <p class="card-text">${respData.items[i].volumeInfo.description}</p>
                <p class="card-text"><small class="text-muted">${respData.items[i].volumeInfo.publishedDate}</small></p>
                <p class="card-text"><small class="text-muted"></small><a href="${respData.items[i].volumeInfo.canonicalVolumeLink}">link to preview</a></p>
              </div>
            </div>`;*/
          let kit= ""
          let ratin = respData.items[i].volumeInfo.averageRating
         if( typeof kit === 'undefined' || typeof ratin === 'undefined' ) {
            let x = ""
            let rx = ""
         }else{
           let kit = respData.items[i].volumeInfo.imageLinks.thumbnail
           let ratin =   respData.items[i].volumeInfo.averageRating    
            text +=` <div class="card-group">
              <div class="card">
                <div class="card-body">
                <img src="${kit}" alt="" width="100" height="132">
                  <h5 class="card-title">${respData.items[i].volumeInfo.authors}</h5>
                  <h5 class="card-title">${respData.items[i].volumeInfo.title}</h5>
                  <h5 class="card-title">  ${ratin}⭐</h5>
                  <p class="card-text">${respData.items[i].volumeInfo.description}</p>
                  <p class="card-text"><small class="text-muted">Published Date: ${respData.items[i].volumeInfo.publishedDate}</small></p>
                  <p class="card-text"><small class="text-muted"></small><a href="${respData.items[i].volumeInfo.canonicalVolumeLink}">link to preview</a></p>
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-save" viewBox="0 0 16 16" id ="save">
                    <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
                  </svg>
                </div>
              </div>`

              }
           /* text +=` <div class="card-group">
            <div class="card">
              <div class="card-body">
              <img src="${x}" alt="W3Schools.com" width="100" height="132">
                <h5 class="card-title">${respData.items[i].volumeInfo.authors}</h5>
                <h5 class="card-title">${respData.items[i].volumeInfo.title}</h5>
                <h5 class="card-title">  ${rx}⭐</h5>
                <p class="card-text">${respData.items[i].volumeInfo.description}</p>
                <p class="card-text"><small class="text-muted">Published Date: ${respData.items[i].volumeInfo.publishedDate}</small></p>
                <p class="card-text"><small class="text-muted"></small><a href="${respData.items[i].volumeInfo.canonicalVolumeLink}">link to preview</a></p>
              </div>
            </div>`;/*
                  
           // items[0].volumeInfo.authors[0]
         }
         /*else{
           
            // let bw = a
                    
              text +=` <div class="card-group">
              <div class="card">
                <div class="card-body">
                <img src="${kit}" alt="W3Schools.com" width="100" height="132">
                  <h5 class="card-title">${respData.items[i].volumeInfo.authors}</h5>
                  <h5 class="card-title">${respData.items[i].volumeInfo.title}</h5>
                  <h5 class="card-title">  ${ratin}⭐</h5>
                  <p class="card-text">${respData.items[i].volumeInfo.description}</p>
                  <p class="card-text"><small class="text-muted">Published Date: ${respData.items[i].volumeInfo.publishedDate}</small></p>
                  <p class="card-text"><small class="text-muted"></small><a href="${respData.items[i].volumeInfo.canonicalVolumeLink}">link to preview</a></p>
                </div>
              </div>`;
            //  console.log(book)

              //  console.log(book)
          } */     
          document.getElementById('authors').innerHTML = text ;
        
         }
        }
            
      
    // console.log(respData.items[0].volumeInfo.imageLinks.thumbnail)
   // console.log(book)
   // document.getElementById('image').src = image;
   //document.getElementById('image').src = imagew;
    
  })
   
   
  
</script>
    
</body>
</html>
